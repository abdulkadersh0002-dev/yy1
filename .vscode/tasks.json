{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "ğŸ§° Check Node.js + npm",
      "type": "shell",
      "command": "powershell",
      "args": [
        "-NoProfile",
        "-ExecutionPolicy",
        "Bypass",
        "-Command",
        "$ErrorActionPreference='Stop'; $node=(Get-Command node -ErrorAction SilentlyContinue); $npm=(Get-Command npm -ErrorAction SilentlyContinue); if(-not $node){Write-Error 'Node.js is not on PATH. Install Node.js 20+ (LTS) and restart VS Code.'; exit 1}; if(-not $npm){Write-Error 'npm is not on PATH. Reinstall Node.js and ensure npm is included.'; exit 1}; node -v; npm -v"
      ],
      "group": "test",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ“¦ Install Dependencies",
      "type": "shell",
      "command": "npm ci",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸš€ Start Server + Dashboard",
      "type": "shell",
      "command": "npm run start:all",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    },
    {
      "label": "ğŸ›°ï¸ Watch Auto-Trading Events (ws)",
      "type": "shell",
      "command": "node",
      "args": ["scripts/diagnostics/watch-auto-trading.mjs", "http://127.0.0.1:4101"],
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "group": "test"
    },
    {
      "label": "ğŸš€ Start Server + Dashboard (NO DB/NO KEYS - synthetic dev)",
      "type": "shell",
      "command": "npm run start:all -- --preset synthetic",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    },
    {
      "label": "ğŸš€ Start Server + Dashboard (ALL symbols)",
      "type": "shell",
      "command": "npm run start:all -- --preset all_symbols",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    },
    {
      "label": "ğŸš€ Start Server + Dashboard (ALL symbols + Full Scan)",
      "type": "shell",
      "command": "npm run start:all -- --preset all_symbols_full_scan",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    },
    {
      "label": "ğŸš€ Start Server + Dashboard (ALL symbols + AUTO trading)",
      "type": "shell",
      "command": "npm run start:all -- --preset all_symbols_auto_trading",
      "dependsOn": ["ğŸ§° Check Node.js + npm", "ğŸ›°ï¸ Watch Auto-Trading Events (ws)"],
      "dependsOrder": "parallel",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    },
    {
      "label": "ğŸš€ Start Server + Dashboard (SMART STRONG MT5 auto)",
      "type": "shell",
      "command": "npm run start:all -- --preset smart_strong_mt5_auto",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    },
    {
      "label": "ğŸš€ Start Server + Dashboard (SMART STRONG MT5 auto + more entries)",
      "type": "shell",
      "command": "npm run start:all -- --preset smart_strong_mt5_more_entries",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    },
    {
      "label": "ğŸš€ Start Server + Dashboard (FX+Metals STRONG AUTO v2)",
      "type": "shell",
      "command": "npm run start:all -- --preset fx_metals_strong_auto_v2",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    },
    {
      "label": "ğŸš€ Start Server + Dashboard (FX+Metals ACTIVE AUTO - more trades)",
      "type": "shell",
      "command": "npm run start:all -- --preset fx_metals_active_auto_more_trades",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    },
    {
      "label": "ğŸš€ Start Server + Dashboard (FX+Metals SMART AUTO - strong trades)",
      "type": "shell",
      "command": "npm run start:all -- --preset fx_metals_smart_auto_strong_trades",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "isBackground": true
    },
    {
      "label": "ğŸ§ª Run Tests",
      "type": "shell",
      "command": "npm test",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "test",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ” Auto-Trading Status (/api/status)",
      "type": "shell",
      "command": "curl.exe",
      "args": ["-s", "http://127.0.0.1:4101/api/status"],
      "group": "test",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ” Run Linter",
      "type": "shell",
      "command": "npm run lint",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "test",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "problemMatcher": ["$eslint-stylish"]
    },
    {
      "label": "ğŸ”§ Fix Linting Issues",
      "type": "shell",
      "command": "npm run lint:fix",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "build",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "âœ¨ Format Code",
      "type": "shell",
      "command": "npm run format:write",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "build",
      "presentation": {
        "reveal": "silent",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ”’ Security Audit",
      "type": "shell",
      "command": "npm audit",
      "dependsOn": ["ğŸ§° Check Node.js + npm"],
      "dependsOrder": "sequence",
      "group": "test",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ§¹ Free Port 4101",
      "type": "shell",
      "command": "powershell",
      "args": [
        "-NoProfile",
        "-ExecutionPolicy",
        "Bypass",
        "-File",
        "scripts/free-ports.ps1",
        "-Ports",
        "4101"
      ],
      "isBackground": false,
      "problemMatcher": [],
      "group": "build"
    },
    {
      "label": "ğŸ” Check Backend Health + EA Quotes (fixed)",
      "type": "shell",
      "command": "cmd",
      "args": [
        "/c",
        "curl -s -o NUL -w \"heartbeat:%{http_code}\\n\" http://127.0.0.1:4101/api/health/heartbeat && curl -s -o NUL -w \"quotes:%{http_code}\\n\" \"http://127.0.0.1:4101/api/broker/bridge/mt5/market/quotes?maxAgeMs=30000\""
      ],
      "isBackground": false,
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "group": "test"
    },
    {
      "label": "ğŸ” EA Bridge Status (mt5)",
      "type": "shell",
      "command": "cmd",
      "args": ["/c", "curl -s \"http://127.0.0.1:4101/api/broker/bridge/status?broker=mt5\""],
      "isBackground": false,
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "group": "test"
    },
    {
      "label": "ğŸ” EA Bridge Status (mt5, 10m)",
      "type": "shell",
      "command": "cmd",
      "args": [
        "/c",
        "curl -s \"http://127.0.0.1:4101/api/broker/bridge/status?broker=mt5^&maxAgeMs=600000\""
      ],
      "isBackground": false,
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "ğŸ” EA Agent Config (mt5)",
      "type": "shell",
      "command": "cmd",
      "args": ["/c", "curl -s \"http://127.0.0.1:4101/api/broker/bridge/mt5/agent/config\""],
      "isBackground": false,
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "group": "test"
    },
    {
      "label": "ğŸ” EA Bridge Statistics",
      "type": "shell",
      "command": "cmd",
      "args": ["/c", "curl -s \"http://127.0.0.1:4101/api/broker/bridge/statistics\""],
      "isBackground": false,
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "ğŸ” Auto-Trading Readiness (mt5)",
      "type": "shell",
      "command": "cmd",
      "args": ["/c", "curl -s \"http://127.0.0.1:4101/api/auto-trading/readiness?broker=mt5\""],
      "isBackground": false,
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "ğŸ” Check EA Candles (BTCEUR M15)",
      "type": "shell",
      "command": "cmd",
      "args": [
        "/c",
        "curl -s -i \"http://127.0.0.1:4101/api/broker/bridge/mt5/market/candles?symbol=BTCEUR^&timeframe=M15^&limit=5^&maxAgeMs=0\""
      ],
      "isBackground": false,
      "problemMatcher": [],
      "group": "test"
    },
    {
      "label": "ğŸ§­ Audit Tape Signals (signal/get + reasons)",
      "type": "shell",
      "command": "node",
      "args": [
        "scripts/diagnostics/audit-tape-signals.mjs",
        "--baseUrl",
        "http://127.0.0.1:4101",
        "--broker",
        "mt5",
        "--max",
        "40"
      ],
      "isBackground": false,
      "problemMatcher": [],
      "group": "test",
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ›‘ Kill Port 4101 Listener",
      "type": "shell",
      "command": "powershell",
      "args": [
        "-NoProfile",
        "-ExecutionPolicy",
        "Bypass",
        "-File",
        "scripts/free-ports.ps1",
        "-Ports",
        "4101"
      ],
      "isBackground": false,
      "group": "build"
    },
    {
      "label": "ğŸ§¹ Free Ports 4101+4173",
      "type": "shell",
      "command": "powershell",
      "args": [
        "-NoProfile",
        "-ExecutionPolicy",
        "Bypass",
        "-File",
        "scripts/free-ports.ps1",
        "-Ports",
        "4101,4173"
      ],
      "isBackground": false,
      "group": "build"
    },
    {
      "label": "ğŸš€ Start Backend (EA-only real)",
      "type": "shell",
      "command": "cmd",
      "args": [
        "/c",
        "set PORT=4101&& set REQUIRE_REALTIME_DATA=true&& set ALLOW_SYNTHETIC_DATA=false&& npm start"
      ],
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "problemMatcher": [],
      "group": "build"
    },
    {
      "label": "ğŸš€ Start Backend (EA-only real + ALL symbols)",
      "type": "shell",
      "command": "cmd",
      "args": [
        "/c",
        "set PORT=4101&& set REQUIRE_REALTIME_DATA=true&& set ALLOW_SYNTHETIC_DATA=false&& set ALLOW_ALL_SYMBOLS=true&& npm start"
      ],
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "problemMatcher": [],
      "group": "build"
    },
    {
      "label": "ğŸš€ Start Dashboard (dev)",
      "type": "shell",
      "command": "cmd",
      "args": [
        "/c",
        "set VITE_DEV_PROXY_TARGET=http://127.0.0.1:4101&& set VITE_API_BASE_URL=http://127.0.0.1:4101&& npm --prefix clients\\neon-dashboard run dev -- --host 127.0.0.1 --port 4173"
      ],
      "isBackground": true,
      "problemMatcher": [],
      "group": "build"
    },
    {
      "label": "ğŸš€ Start Backend (4101)",
      "type": "shell",
      "command": "cmd",
      "args": ["/c", "set PORT=4101&& npm start"],
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "group": "build"
    },
    {
      "label": "ğŸš€ Start Backend (4101, NO DB/NO KEYS - synthetic dev)",
      "type": "shell",
      "command": "cmd",
      "args": [
        "/c",
        "set PORT=4101&& set ALLOW_SYNTHETIC_DATA=true&& set REQUIRE_REALTIME_DATA=false&& set NEWS_RSS_ONLY=true&& npm start"
      ],
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "group": "build"
    },
    {
      "label": "ğŸš€ Start Backend (4101, legacy WAIT_MONITOR flag)",
      "type": "shell",
      "command": "cmd",
      "args": ["/c", "set PORT=4101&& npm start"],
      "isBackground": true,
      "presentation": {
        "reveal": "always",
        "panel": "dedicated"
      },
      "group": "build"
    }
  ]
}
